<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <!-- bootstraps and jquery cdn -->
    <link rel="stylesheet" href="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/css/bootstrap.min.css">
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.0/jquery.min.js"></script>
    <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.4.1/js/bootstrap.min.js"></script>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/axios/0.27.2/axios.min.js"></script>
    <title>Daily Expenses</title>
</head>

<body>
    <div class="form-group">
        <label class="col-md-4 control-label" for="logout-btn"></label>
        <div class="col-md-pull-4">
            <button style="margin-left: 90%; " id="logout-btn" name="login-btn" class="btn btn-primary">Log Out</button>
            
        </div>
    </div>
    <form class="form-horizontal">


        <!-- Form Name -->
        <legend style="text-align: center;">Daily Expenses</legend>

        <!-- Text input-->
        <div class="form-group">
            <label class="col-md-4 control-label" for="spent-money">Spent Money</label>
            <div class="col-md-5">
                <input id="spent-money" name="spent-money" type="text" placeholder="EXPENSES"
                    class="form-control input-md">

            </div>
        </div>

        <!-- Textarea -->
        <div class="form-group">
            <label class="col-md-4 control-label" for="description">Description</label>
            <div class="col-md-4">
                <textarea class="form-control" id="description" name="description">Description</textarea>
            </div>
        </div>

        <!-- Select Basic -->
        <div class="form-group">
            <label class="col-md-4 control-label" for="category">Category</label>
            <div class="col-md-5">
                <select id="category" name="category" class="form-control">
                    <option value="food">Food</option>
                    <option value="petrol">Petrol</option>
                    <option value="travel">Travel</option>
                </select>
            </div>
        </div>


    </form>
    <div class="form-group">
        <label class="col-md-4 control-label" for="login-btn"></label>
        <div class="col-md-pull-4">
            <button style="margin-left: 10px;" id="submit-btn" name="login-btn" class="btn btn-primary">Submit</button>
            <button style="margin-left: 5px;" id="reset-btn" name="reset-btn" class="btn btn-primary">Reset</button>
        </div>
    </div>

    <script>
        window.addEventListener('load', () => {
    console.log('loaded');
    
    axios.get('http://localhost:8000/expenses').then((expense) => {
        console.log(expense)
        
    })

})
        const logOut=document.getElementById('logout-btn')
        logOut.addEventListener('click',(e)=>{
            axios.get('http://localhost:8000/logout')
                .then(response=>{
                    if(response.data.jwt===false){
                        window.location.href='./login.html'
                    }
                })
                .catch(err=>{
                    console.log(err);
                })
        })

        const submit=document.getElementById('submit-btn')
        submit.addEventListener('click',(e)=>{
            e.preventDefault();
            // const expense=document.getElementById('spent-money').value;
            // const description=document.getElementById('description').value;
            // const category=document.getElementById('category').value;
            const expenseDetails={
                expense:document.getElementById('spent-money').value,
                description:document.getElementById('description').value,
                category:document.getElementById('category').value,
            }
            axios.post('http://localhost:8000/addExpense',expenseDetails)
                .then(response=>{
                    console.log("logged In",response);
                    console.log(response.data.isSucces);
                    // if(response.data.isSucces===false){
                    //     alert(`${response.data.email} is already exist, Please Login`)
                    // }
                    // if(response.data.isSucces){
                    //     alert(`${response.data.user.email} Successfuly signed up`);
                    //     window.location.href='./login.html'
                    // }
                })
                .catch(err=>{
                console.log(err);
            })

        })
    </script>
    

</body>

</html>